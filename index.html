<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TJ ì„¼í„°ìš© ë¹ ë¥¸ê²€ìƒ‰</title>
<meta name="theme-color" content="#ffffff"/>
<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
  margin:0;padding:20px;background:#fff;
}
h1{font-size:22px;margin-bottom:14px;}
input{
  width:100%;
  font-size:22px;
  padding:16px;
  border:1px solid #ccc;
  border-radius:16px;
  margin-bottom:12px;
}
button{
  font-size:20px;
  padding:16px;
  border:0;
  border-radius:16px;
  cursor:pointer;
}
.row{display:flex;gap:10px;margin-bottom:10px;}
.row button{flex:1;}
.section{margin-top:20px;}
.list button{
  width:100%;
  text-align:left;
  margin-bottom:8px;
  background:#f3f3f3;
}
.small{font-size:14px;opacity:.7;}
</style>
</head>
<body>

<h1>ğŸ¤ TJ ì„¼í„° ë¹ ë¥¸ê²€ìƒ‰</h1>

<input id="q" placeholder="ê³¡ ì œëª© / ê°€ìˆ˜ ì…ë ¥ ë˜ëŠ” ë§ë¡œ ì…ë ¥"/>

<div class="row">
  <button id="voice">ğŸ™ï¸ ë§ë¡œ ì…ë ¥</button>
  <button id="copyOpen">ğŸ” ë³µì‚¬ + TJì—´ê¸°</button>
</div>

<div class="row">
  <button id="favSave">â­ ì¦ê²¨ì°¾ê¸° ì¶”ê°€</button>
  <button id="clear">ğŸ§¹ ì§€ìš°ê¸°</button>
</div>

<div class="section">
  <h3>â­ ì¦ê²¨ì°¾ê¸°</h3>
  <div id="favorites" class="list"></div>
</div>

<div class="section">
  <h3>ğŸ•˜ ìµœê·¼ ê²€ìƒ‰</h3>
  <div id="recent" class="list"></div>
</div>

<p class="small">
ì‚¬ìš© íë¦„: ë§ë¡œ ì…ë ¥ â†’ ğŸ”ë³µì‚¬+TJì—´ê¸° â†’ TJì—ì„œ ë¶™ì—¬ë„£ê¸°
</p>

<script>
const q = document.getElementById('q');
const favBox = document.getElementById('favorites');
const recentBox = document.getElementById('recent');

function saveRecent(text){
  let arr = JSON.parse(localStorage.getItem('recent')||'[]');
  arr = arr.filter(v=>v!==text);
  arr.unshift(text);
  arr = arr.slice(0,10);
  localStorage.setItem('recent',JSON.stringify(arr));
  renderRecent();
}

function saveFav(text){
  let arr = JSON.parse(localStorage.getItem('fav')||'[]');
  if(!arr.includes(text)){
    arr.unshift(text);
    localStorage.setItem('fav',JSON.stringify(arr));
  }
  renderFav();
}

function renderRecent(){
  let arr = JSON.parse(localStorage.getItem('recent')||'[]');
  recentBox.innerHTML='';
  arr.forEach(text=>{
    const b=document.createElement('button');
    b.textContent=text;
    b.onclick=()=>{q.value=text;}
    recentBox.appendChild(b);
  });
}

function renderFav(){
  let arr = JSON.parse(localStorage.getItem('fav')||'[]');
  favBox.innerHTML='';
  arr.forEach(text=>{
    const b=document.createElement('button');
    b.textContent=text;
    b.onclick=()=>{q.value=text;}
    favBox.appendChild(b);
  });
}

document.getElementById('copyOpen').onclick=async()=>{
  const text=q.value.trim();
  if(!text) return alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
  await navigator.clipboard.writeText(text);
  saveRecent(text);
  window.open('https://www.tjmedia.com/song/accompaniment','_blank');
};

document.getElementById('favSave').onclick=()=>{
  const text=q.value.trim();
  if(!text) return;
  saveFav(text);
};

document.getElementById('clear').onclick=()=>{
  q.value='';
};

document.getElementById('voice').onclick=()=>{
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SR) return alert('Chrome ë¸Œë¼ìš°ì € ì‚¬ìš© ê¶Œì¥');
  const rec=new SR();
  rec.lang='ko-KR';
  rec.onresult=e=>{
    q.value=e.results[0][0].transcript;
  };
  rec.start();
};

renderRecent();
renderFav();
</script>

</body>
</html>
